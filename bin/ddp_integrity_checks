#!/usr/bin/env python3
"""
Used mainly for integrity tests of atomid->url
"""

import pandas as pd
import random
from pprint import pprint

import fargv

from ddp_util import chatomid_to_url

#make sampling.ipynb output all atomids (possible issue with double parameter chatomid_to_url?); refactor here; 
def nestedjson2list(json):  
    all_df_full = pd.read_json(json)
    all_atomids = all_df_full.explode("atom_id")["atom_id"].rename("atomid").to_list()
    return random.sample(all_atomids, 20)
    #return all_atomids



if __name__ == "__main__":
    p = {
        "root": ".",
        "data": "./data/output/",
        "local_mom": "localhost:8080/mom/"
    }

args, _ = fargv.fargv(p)

atomids = json2list(f"{args.data}/charters_full_2022-11-22-1044.json")
urls = [chatomid_to_url(atomid, root=args.local_mom) for atomid in atomids]
